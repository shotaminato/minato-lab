:description: Antoraã‚’ä½¿ã£ã¦ã€è‡ªä½œã®Asciidocãƒ•ã‚¡ã‚¤ãƒ«ã‚’Webãƒšãƒ¼ã‚¸ã«å¤‰æ›ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦è¨˜è¼‰ã—ã¾ã™ã€‚

= Antoraã®å§‹ã‚æ–¹

== Install WSL

Antoraã‚’å–ã‚Šæ‰±ã†ã®ã«éƒ½åˆãŒã„ã„ã®ã§ã€WSLã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

å‚è€ƒãƒšãƒ¼ã‚¸: https://qiita.com/SBS_Takumi/items/f5f8a5934e00c7a7efb8

[%linenums,sh]
----
$ wsl --install
----




== VScodeã®ãƒ•ã‚©ãƒ³ãƒˆå¤‰æ›´
Windowsã®ãƒ•ã‚©ãƒ³ãƒˆã¯æ±šã„ã®ã§ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã—ã¦ã€ãƒ•ã‚©ãƒ³ãƒˆã‚’å¤‰æ›´ã—ã¾ã™ã€‚

å‚è€ƒãƒšãƒ¼ã‚¸: https://qiita.com/haya_ken/items/d9f32bcbb6cd0e6199ed

Font Family ã« `'Source Han Code JP'` ã¨ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãã§æŒ‡å®šã™ã‚‹ã¨ã†ã¾ãã„ãã¾ã—ãŸã€‚





== Install Chrome (WSL)
è‡ªä½œã‚µã‚¤ãƒˆã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã«ã€WSLã«chromeã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦é€²ã‚ã¦ãã ã•ã„ã€‚

[%linenums,sh]
----
$ sudo apt update && sudo apt -y upgrade && sudo apt -y autoremove
$ cd /path/to/workdir/
$ mkdir chrome && cd chrome
$ wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
$ sudo apt -y install ./google-chrome-stable_current_amd64.deb
----

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã£ã¦ã€chromeã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰æˆåŠŸã§ã™ã€‚

[%linenums,sh]
----
google-chrome --version
----

å‚è€ƒãƒšãƒ¼ã‚¸: https://scottspence.com/posts/use-chrome-in-ubuntu-wsl






=== æ—¥æœ¬èªåŒ–

ä»¥ä¸Šã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ã®ã¿ã ã¨ã€æ—¥æœ¬èªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¦ã„ã¾ã›ã‚“ã€‚ä¸‹è¨˜ã®ã‚µã‚¤ãƒˆã‚’å‚è€ƒã«ã€WSLç’°å¢ƒã‚’æ—¥æœ¬èªåŒ–ã—ã¾ã™ã€‚

[%linenums,sh]
----
$ sudo apt -y install language-pack-ja
$ sudo update-locale LANG=ja_JP.UTF8
$ sudo apt install fonts-ipafont
$ sudo apt install fonts-ipaexfont
$ fc-cache -fv
----

å‚è€ƒ1: https://windows-core.com/windows_feature/feature-52.php
å‚è€ƒ2: https://lef237.hatenablog.com/entry/2022/12/05/163550

å‚è€ƒ2ã®ã‚ˆã†ã«ãƒ•ã‚©ãƒ³ãƒˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãªã„ã¨ã€æ–‡å­—åŒ–ã‘ã¯æ²»ã‚Šã¾ã›ã‚“ã€‚

ã“ã®ã¾ã¾ã ã¨ã€ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸãŸã‚ã€ä¿®æ­£ã—ã¾ã™ã€‚

----
manpath: can't set the locale; make sure $LC_* and $LANG are correct wsl
----

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€åœ°åŸŸè¨­å®šã‚’å¤‰æ›´ã—ã¾ã™ã€‚

[%linenums,sh]
----
$ sudo dpkg-reconfigure locales 
----

æ“ä½œæ–¹æ³•ã¯ã€`ja_JP.UTF8` çš„ãªé¸æŠè‚¢ã‚’äºŒå›ç¨‹åº¦é¸æŠã™ã‚Œã°Okã§ã™ã€‚

å‚è€ƒ: https://gist.github.com/n3dst4/173e17ef502f7897582f9021135c3669

== Antora
ä»¥ä¸‹ã€ã“ã®ãƒšãƒ¼ã‚¸ã‚’å‚è€ƒã«é€²ã‚ã¦ã„ãã¾ã™ã€‚

å‚è€ƒãƒšãƒ¼ã‚¸: https://docs.antora.org/antora/latest/install-and-run-quickstart/







=== Install Node.js

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã£ã¦ã¿ã¾ã™ã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€Node.jsã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã€‚ãã†ã§ãªã‘ã‚Œã°æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ã™ã€‚

[%linenums,sh]
----
$ node -v
----

ç§ã®ç’°å¢ƒã§ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œãªã‹ã£ãŸã®ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãã¾ã™ã€‚ +
nvmã¨å‘¼ã°ã‚Œã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚½ãƒ•ãƒˆãŒã‚ã‚‹ã‚ˆã†ãªã®ã§ã€ãã‚Œã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ +

å‚è€ƒãƒšãƒ¼ã‚¸: https://github.com/nvm-sh/nvm#installation-and-update

.Install NVM
[%linenums,sh]
----
$ curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh | bash

$ export NVM_DIR="$([ -z "${XDG_CONFIG_HOME-}" ] && printf %s "${HOME}/.nvm" || printf %s "${XDG_CONFIG_HOME}/nvm")"
$ [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
----

.Install Node.js
[%linenums,sh]
----
$ nvm install --lts
$ node -v # Version ç¢ºèª
v22.11.0
$ nvm alias default 16 # ã“ã‚Œã¯ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦å®Ÿè¡Œã§ããšã€‚å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 16 ãŒãªã„ã€‚
$ nvm alias default v22.11.0 # ä»£ã‚ã‚Šã«ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¤ã€‚ã“ã‚Œã¯ã€ç’°å¢ƒå¤‰æ•°ã®è¨­å®šã«å¿…è¦ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ãŸãªã„ã¨ä¾‹ãˆã°æ–°ã—ã„ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ç«‹ã¡ä¸Šã’ãŸã¨ãã«ã€npxã‚³ãƒãƒ³ãƒ‰ã‚„nodeã‚³ãƒãƒ³ãƒ‰ã€npmã‚³ãƒãƒ³ãƒ‰ãªã©ãŒä½¿ç”¨ã§ããªããªã‚‹ã€‚
----




=== Install Antora

.Install command
[%linenums,sh]
----
$ mkdir docs-site && cd docs-site
$ node -e "fs.writeFileSync('package.json', '{}')"
$ npm i -D -E antora # ã“ã“ã§ Warning ãŒå‡ºãŸã€‚
----

.Warning
[%linenums,sh]
----
npm warn deprecated inflight@1.0.6: This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.
npm warn deprecated glob@7.1.3: Glob versions prior to v9 are no longer supported
----

`Node.js` ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæ–°ã—ã™ãã¦ã€ `Antora` ãŒä½¿ç”¨ã—ã¦ã„ã‚‹é–¢æ•°ãŒå»ƒæ­¢ã•ã‚Œã¦ã„ã‚‹ã‚‰ã—ã„ã€‚ã„ã£ãŸã‚“ç„¡è¦–ã—ã¦é€²ã‚ã‚‹ã€‚




=== Antora Test

è‡ªä½œã‚µã‚¤ãƒˆã‚’ä½œã‚‹ãŸã‚ã«ã¯ã€Antoraã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆplaybookï¼‰ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚‰ã—ã„ã§ã™ã€‚å…ˆã»ã©ä½œã£ãŸ `docs-site` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« `antora-playbook.yml` ã‚’ä½œæˆã—ã¾ã™ã€‚

.antora-playbook.yml
[%linenums,yml]
----
site:
  title: Docs Site
  start_page: component-b::index.adoc # ã“ã“ã«ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã®asciidocã‚’æŒ‡å®šã—ã¾ã™ã€‚
content:
  sources: 
  - url: https://gitlab.com/antora/demo/demo-component-a.git
    branches: HEAD
  - url: https://gitlab.com/antora/demo/demo-component-b.git
    branches: [v2.0, v1.0]
    start_path: docs
ui: 
  bundle:
    url: https://gitlab.com/antora/antora-ui-default/-/jobs/artifacts/HEAD/raw/build/ui-bundle.zip?job=bundle-stable
    snapshot: true
----


ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã€ã‚µã‚¤ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚

.Antoraã®ç«‹ã¡ä¸Šã’
[%linenums,sh]
----
$ npx antora antora-playbook.yml
----

å®Ÿè¡Œçµæœã¨ã—ã¦ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«URLãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

.ç”Ÿæˆçµæœï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ï¼‰
[%linenums,sh]
----
Site generation complete!
Open file:///home/XXXXXXXXX/HOME/docs-site/build/site/index.html in a browser to view your site.
----

ã“ã®URLã‚’ã€chromeã«å…¥åŠ›ã™ã‚Œã°ã€ä½œæˆã—ãŸã‚µã‚¤ãƒˆã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ãã¾ã™ã€‚chromeã¯ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§èµ·å‹•ã—ã¾ã™ã€‚èµ·å‹•ã§ããªã„å ´åˆã¯ã€ <<Install Chrome (WSL)>> ã‚’å‚è€ƒã«ã€chrome ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚
----
$ google-chrome
----

ä»¥ä¸‹ã®ã‚ˆã†ãªç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸã§ã™ã€‚

image::antora_demo.png[]

æ¬¡ç« ã‹ã‚‰ã€è‡ªä½œã®Asciidocãƒ•ã‚¡ã‚¤ãƒ«ã‚’Antoraã§å¤‰æ›ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦è¿°ã¹ã¾ã™ã€‚


=== How to use Antora

==== Antora ã®ãŸã‚ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ä½œæˆ

Antora ã¯ã€asciidocã§è¨˜è¼‰ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’htmlãƒ™ãƒ¼ã‚¹ã®ã‚µã‚¤ãƒˆã«å¤‰æ›ã—ã¦ãã‚Œã¾ã™ã€‚ã“ã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«ã¯ã€ã¾ãšAntoraãŒèªè­˜ã§ãã‚‹ã‚ˆã†ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’æ±ºã‚ã‚‰ã‚ŒãŸå½¢å¼ã«æ•´ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

æœ€å°æ§‹æˆã¯ã€ä¸‹è¨˜ã®ã‚ˆã†ãªå½¢ã§ã™ã€‚


----
ğŸ“’repository <1>
  ğŸ“„antora.yml <2>
  ğŸ“‚modules <3>
    ğŸ“‚ROOT <4>
      ğŸ“‚pages <5>
        ğŸ“„page-source-file.adoc <6>
----

<1> Repository ã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
<2> Antora ç”¨ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€‚Repository ã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç›´ä¸‹ã«ç½®ãã¾ã™ã€‚åå‰ã¯å¤‰æ›´ã§ãã¾ã›ã‚“ã€‚
<3> modules directory.
<4> ROOT module directory.
<5> pages family directory.
<6> Source file of a page.

å‚è€ƒãƒšãƒ¼ã‚¸: https://docs.antora.org/antora/latest/standard-directories/

ä»Šå›ã¯ã“ã®ã‚ˆã†ã«ä½œæˆã—ã¾ã™ã€‚

----
ğŸ“’my_homepage
  ğŸ“‚modules 
    ğŸ“‚ROOT 
      ğŸ“‚images 
      ğŸ“‚pages 
        ğŸ“„test-book.adoc 
      ğŸ“„nav.adoc 
  ğŸ“„antora-playbook.yml 
  ğŸ“„antora.yml
----

å„ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã¯ã“ã†ãªã£ã¦ã„ã¾ã™ã€‚

.antora-playbook.yml
[,yml]
----
site:
  title: Minato Lab
  start_page: minato-lab::README.adoc
content:
  sources:
  - url: .
    branches: HEAD
ui:
  bundle:
    url: https://gitlab.com/antora/antora-ui-default/-/jobs/artifacts/HEAD/raw/build/ui-bundle.zip?job=bundle-stable
    snapshot: true
----


.antora.yml
[,yml]
----
name: minato-lab
version: ~
title: Minato Lab
nav:
- modules/ROOT/nav.adoc
----


.test-book.adoc
[,adoc]
----
= Hellow World.

ãƒ†ã‚¹ãƒˆã§ã™ã€‚
----


.ROOT/nav.adoc
[,adoc]
----
* xref:test-book.adoc[]
----


=== Github Action ã®è¨­å®š

ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

./.github/workflows/publish.yml
[,yml]
----
name: Publish to GitHub Pages
on:
  push:
    branches: [main]
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:
concurrency:
  group: github-pages
  cancel-in-progress: false
# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write
jobs:
  build:
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
    - name: Configure Pages
      uses: actions/configure-pages@v5
    - name: Install Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
    - name: Install Antora
      run: npm i antora
    - name: Generate Site
      run: npx antora antora-playbook.yml
    - name: Upload Artifacts
      uses: actions/upload-pages-artifact@v3
      with:
        path: build/site
    - name: Deploy to GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v4
----

Githubã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚Œã°ã€è‡ªå‹•ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™ã€‚

å‚è€ƒãƒšãƒ¼ã‚¸: https://docs.antora.org/antora/latest/publish-to-github-pages/#using-github-actions

